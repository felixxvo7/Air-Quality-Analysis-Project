---
title: "R Notebook"
output: html_notebook
---

```{r}
# R version: 4.4.3

if (!require("tidyverse")) {
    install.packages("tidyverse")
}

if (!require("keras")) {
    install.packages("keras")
}

library("keras")
library("tidyverse")
```

```{R}
# Example: Load dataset (adjust based on your actual data source)
df <- read.csv("../formated_data.csv")
head(df)

```

```{R}
# Define predictors (exclude Date, Time, and targets)
predictors <- df %>% select(-c(Date, Time, CO.GT., C6H6.GT., NOx.GT., NO2.GT.))

# Define multiple target variables (CO, NOx, Benzene)
targets <- df %>% select(CO.GT., C6H6.GT., NOx.GT., NO2.GT.)

# Normalize data (optional but recommended)

normalize <- function(x) { 
  (x - min(x)) / (max(x) - min(x)) 
}

predictors <- as.data.frame(lapply(predictors, normalize))
targets <- as.data.frame(lapply(targets, normalize))

# Convert to matrices for Keras
X <- as.matrix(predictors)
Y <- as.matrix(targets)
```